/*! 
 * jQuery Base Color Plugin
 * Version: 0.1.0
 * URL: https://github.com/bryanstedman/jqueryBaseColor
 * Description: A jQuery plugin that paints an image to canvas and calulates a base color
 * Requires: jQuery & quantize.js
 * Author: Bryan Stedman, http://bryanstedman.com
 * Copyright: Copyright 2013 Bryan Stedman
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
;(function(a){"use strict";function f(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p;for(null===f&&(f=8),i=a.getContext("2d").getImageData(b,c,d,e).data,j=[],l=m=c,o=c+e;o>m;l=m+=1)for(h=4*l*d,k=n=b,p=b+d;p>n;k=n+=1)g=h+4*k,j.push([i[g],i[g+1],i[g+2]]);return(new MMCQ).quantize(j,f)}function g(a,b){var d,e,g,i,c="";return a.height=Math.round(a.height*(200/a.width)),a.width=200,b.width=a.width,b.height=a.height,b.getContext("2d").drawImage(a,0,0,a.width,a.height),e=f(b,0,0,.5*a.width,a.height,4),g=e.cboxes.map(function(a){return{count:a.cbox.count(),rgb:a.color}}),g.sort(function(a,b){return b.count-a.count}),d=g[0].rgb,i=function(a){return"rgb("+a[0]+", "+a[1]+", "+a[2]+")"},c=i(d)}var e={canvasID:"baseColorCanvas",hideCanvas:!0,canvasWidth:"200px",canvasHeight:"200px"};a.fn.baseColor=function(b){var c,d,f;return this.options=a.extend({},e,b),0==a("#"+this.options.canvasID).length&&(d=a("<canvas/>",{id:this.options.canvasID}).width(200).height(200),a("body").append(d)),c=a("#"+this.options.canvasID)[0],a(c).css({height:this.options.canvasHeight,width:this.options.canvasWidth}),this.options.hideCanvas&&a(c).hide(),f=new Image,f.src=a(this).attr("src"),g(f,c)}})(jQuery,document,window);